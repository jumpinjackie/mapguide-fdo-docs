<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MapGuide API Reference: Feature Provider Registry</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../mg_open_source.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">MapGuide API Reference
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.htm"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.htm"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.htm"><span>Modules</span></a></li>
      <li><a href="../../annotated.htm"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d8/d50/group___feature_provider_registry.htm','../../');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Feature Provider Registry</div>  </div>
<div class="ingroups"><a class="el" href="../../de/ddf/group___feature___service___module.htm">Feature Service</a></div></div><!--header-->
<div class="contents">
<p>The feature provider registry contains most importantly the name of each available provider, version information and the name of the provider DLL. The full set of registry information elements and attributes is specified in the XML schema <a class="el" href="../../de/de6/group___feature_provider_registry__schema.htm">FeatureProviderRegistry </a>. </p>
<div class="PhpExample">
<b>Example (PHP)</b>
<br>
 <p>The FeatureProviders constructor takes the XML string containing the provider registry as an argument. It creates an array of FeatureProvider objects. Currently it only parses the Name elements from the registry information. </p>
<div class="fragment"><pre class="fragment">&lt;?php
<span class="keyword">class </span>FeatureProviders {
   var $xpath;
   var $featureProviders;
   var $logFileHandle;
   <span class="keyword">function</span> arrayOfProviderNames() {
       <span class="keywordflow">return</span> array_keys($this-&gt;featureProviders);
   }
   <span class="keyword">function</span> FeatureProviders( $logFileHandle, $byteReader ) {
      $this-&gt;logFileHandle = $logFileHandle;
      $doc = <span class="keyword">new</span> DOMDocument();
        $xmlStr = $byteReader-&gt;ToString();
        $doc-&gt;loadXML($xmlStr);
      $this-&gt;xpath = <span class="keyword">new</span> DOMXPath($doc);
      $this-&gt;queryProviders();
   }
   <span class="keyword">function</span> queryProviders() {
      $providers = $this-&gt;xpath-&gt;query(<span class="stringliteral">&quot;//FeatureProviderRegistry/FeatureProvider&quot;</span>);
      $count = $providers-&gt;length;
      <span class="keywordflow">for</span>($i=0; $i&lt;$count; $i++) {
             $provider = $providers-&gt;item($i);
            $providerElements = $provider-&gt;childNodes;
            $connectionProperties = NULL;
             <span class="keywordflow">foreach</span>($providerElements as $providerElement) {
                $providerElemTagname = $providerElement-&gt;tagName;
                <span class="keywordflow">if</span> ($providerElemTagname == <span class="stringliteral">&quot;Name&quot;</span>) {
                   $providerName = $providerElement-&gt;nodeValue;
                   $featureProvider = <span class="keyword">new</span> FeatureProvider($providerName);
                } 
             }
           $this-&gt;featureProviders[$providerName] = $featureProvider;
      }
   }
}
<span class="keyword">class </span>FeatureProvider {
   var $providerName;
   var $connectionProperties = NULL;
   <span class="keyword">function</span> FeatureProvider( $providerName ) {
      $this-&gt;providerName = $providerName;
   }
   <span class="keyword">function</span> GetProviderName() {
      <span class="keywordflow">return</span> $providerName;
   }
}
?&gt;
</pre></div> </div>
<div class="CSharpExample">
<b>Example (C#)</b>
<br>
 <p>The GetProviderNames method gets the provider registry from Feature Services. The registry is in xml and the method uses an xpath expression to retrieve the provider names. It concatenates the provider names for use in a test expression. </p>
<p>The following string is an example of the output from this program. "Autodesk.Oracle.3.2 Autodesk.Raster.3.2 Autodesk.SqlServer.3.2 OSGeo.ArcSDE.3.2 OSGeo.MySQL.3.2 OSGeo.ODBC.3.2 OSGeo.SDF.3.2 OSGeo.SHP.3.2 OSGeo.WFS.3.2 OSGeo.WMS.3.2" </p>
<p>The utility method shows the use of System Xml classes to extract values from the xml. </p>
<div class="fragment"><pre class="fragment"><span class="keyword">using</span> OSGeo.MapGuide;
<span class="comment">// The MgFeatureService example code shows how the MgFeatureService object is created.</span>
<span class="keyword">private</span> <a class="code" href="../../d5/d10/class_mg_feature_service.htm" title="Provides an abstraction layer for the storage and retrieval of feature data in a technology-independe...">MgFeatureService</a> featureService;
<span class="keyword">private</span> String providerNamesActual;

<span class="keyword">private</span> <span class="keywordtype">void</span> GetProviderNames()
{
    System.Globalization.CultureInfo culture = <span class="keyword">new</span> System.Globalization.CultureInfo(0x0409);
    String[] names;
    <a class="code" href="../../d8/d50/class_mg_byte_reader.htm" title="Reads data from a byte source. Once read, the data in the reader cannot be reread.">MgByteReader</a> byteReader = featureService.<a class="code" href="../../d5/d10/class_mg_feature_service_a07eb2528a8cc6766f883ea73a32fdf7a.htm#a07eb2528a8cc6766f883ea73a32fdf7a" title="Gets a list of the available FDO providers together with other information such as the names of the c...">GetFeatureProviders</a>();
    String xmlContent = byteReader.<a class="code" href="../../d8/d50/class_mg_byte_reader_a25d2942487453f2c02a9edd600b0a6b4.htm#a25d2942487453f2c02a9edd600b0a6b4" >ToString</a>();
    names = GetXpathValuesRtnStrArr(xmlContent,
        <span class="stringliteral">&quot;//FeatureProviderRegistry/FeatureProvider/Name&quot;</span>);
    providerCountActual = names.GetLength(0);
    Array.Sort(names, StringComparer.Create(culture, <span class="keyword">false</span>));
    providerNamesActual = StringArrayToString(names);
}

<span class="keyword">private</span> String[] GetXpathValuesRtnStrArr(String xmlContent, String xpath)
{
    System.Collections.ArrayList strList = <span class="keyword">new</span> System.Collections.ArrayList(10);
    String[] strArr;
    System.Xml.XmlDocument xmlDocument = <span class="keyword">new</span> XmlDocument();
    xmlDocument.LoadXml(xmlContent);
    XmlNodeList nodeList;
    XmlElement root = xmlDocument.DocumentElement;
    nodeList = root.SelectNodes(xpath);
    <span class="keywordtype">int</span> count = nodeList.Count;
    <span class="keywordflow">if</span> (count == 0)
    {
        strArr = <span class="keyword">new</span> String[] { <span class="stringliteral">&quot;&quot;</span> };
        <span class="keywordflow">return</span> strArr;
    }
    XmlNode node;
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; i++)
    {
        node = nodeList.Item(i);
        strList.Add(node.FirstChild.Value);
    }
    strArr = (String[])strList.ToArray(typeof(<span class="keywordtype">string</span>));
    <span class="keywordflow">return</span> strArr;
}

GetProviderNames();
System.Console.WriteLine(providerNamesActual);
</pre></div> </div>
 </div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">Comments or suggestions? Send us <a href="http://mapguide.osgeo.org/feedback">feedback</a>. | Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>

